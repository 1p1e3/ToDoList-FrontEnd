<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <div id="app">
        <h1 class="title">ToDoList</h1>
        <div class="adddiv">
            <h3>添加</h3>
            <div style="margin-top: 15px;">
                <el-input placeholder="请输入内容" v-model="item">
                    <el-button slot="append" style="background-color: #409eff;color: #fff;" icon="el-icon-plus" @click="add"></el-button>
                </el-input>
            </div>
        </div>
        <el-divider></el-divider>
        <div class="list">
            <h3>待办事项</h3>
            <div>
                <el-radio-group v-model="type" @change="get">
                <el-radio-button label="全部"></el-radio-button>
                <el-radio-button label="已完成"></el-radio-button>
                <el-radio-button label="未完成"></el-radio-button>
                </el-radio-group>
            </div>
            <!-- list -->
            <el-table :data="tableData" height="350" :row-class-name="tableRowClassName">
                <el-table-column prop="ID" label="ID"></el-table-column>
                <el-table-column prop="Name" label="事项"></el-table-column>
                <el-table-column label="操作">
                    <template slot-scope="scope">
                      <el-button
                        size="mini"
                        type="primary"
                        @click="handleEdit(scope.$index, scope.row)">完成</el-button>
                      <el-button
                        size="mini"
                        type="danger"
                        @click="handleDelete(scope.$index, scope.row)">删除</el-button>
                    </template>
                </el-table-column>
            </el-table>
        </div>
    </div>
</body>
</html>
<style>
    #app{
        width: 60%;
        margin: 0 auto;
        /* border: solid 1px #42b983;
        border-radius: 10px; */
    }
    .title {
        font-weight: bold;
    }
    .adddiv {
        width: 500px;
    }
    .el-table .warning-row {
        background: oldlace;
    }

    .el-table .success-row {
        background: #f0f9eb;
    }
</style>
<script>
    var app = new Vue({
    el: '#app',
    data: {
        item: '',
        addmsg: '',
        addresult: '',
        type: '全部',
        tableData: null
    },
    methods: {
        add() {
            if (this.item == '') {
                this.$message.error('事项不能为空');
            }
            axios({
            method: 'post',
            url: 'http://127.0.0.1:8080/todo',
            data: {
                name: this.item
            }
            })
            this.$message({
            message: '添加成功',
            type: 'success'
            })
        },
        get() {
            if (this.type == '全部') {
                axios({
                method: 'post',
                url: 'http://127.0.0.1:8080/todolist',
                data: {
                    w: "all"
                }
                }).then(function (response) {
                    for (let i = 0; i < response.data.data.length; i++) {
                        this.tableData[i] = response.data.data[i]
                    }
                    console.log(this.tableData);
                })
            }
            if (this.type == '已完成') {
                axios({
                method: 'post',
                url: 'http://127.0.0.1:8080/todolist',
                data: {
                    w: "finished"
                }
                }).then(function (response) {
                    this.tableData = response.data.data
                })
            }
            if (this.type == '未完成') {
                axios({
                method: 'post',
                url: 'http://127.0.0.1:8080/todolist',
                data: {
                    w: "created"
                }
                }).then(function (response) {
                    this.tableData = response.data.data
                })
            }
        },
        tableRowClassName({row, rowIndex}) {
            if (rowIndex === 1) {
                return 'warning-row';
            } else if (rowIndex === 3) {
                return 'success-row';
            }
            return '';
        }

    },
    beforeMount() {
        axios({
            method: 'post',
            url: 'http://127.0.0.1:8080/todolist',
            data: {
                w: "all"
            }
            }).then(function (response) {
                this.tableData = response.data.data
                console.log(this.tableData);
            })
        }
    })
</script>